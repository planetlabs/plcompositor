# @configure_input@

prefix = @prefix@

OPTFLAGS = -Wall -g -DDEBUG

CC       = @CC@
CFLAGS   = @CFLAGS@
CPPFLAGS = @CPPFLAGS@ @GDAL_CFLAGS@ $(OPTFLAGS)
LDFLAGS  = @LDFLAGS@

all: compositor

Makefile: Makefile.in config.status
	./config.status Makefile

config.status: configure
	./config.status --recheck

LIBS = 	-lwjelement -lwjreader @GDAL_LDFLAGS@

OBJ =	src/plcinput.o \
	src/plcline.o \
	src/plccontext.o \
	src/plchistogram.o \
	src/sourcepostprocess.o \
	\
	src/qualitymethodbase.o \
	src/linecompositor.o \
	src/darkestquality.o \
	src/greenestquality.o \
	src/scenemeasurequality.o \
	src/landsat8cloudquality.o \
	src/percentilequality.o \
	src/qualityfromfile.o \
	src/samesourcequality.o

compositor:	src/compositor.o $(OBJ)
	$(CXX) $(LDFLAGS) -o $@ $^ $(LIBS)

$(OBJ):	src/compositor.h Makefile

clean:
	rm -f $(OBJ) src/compositor.o compositor

check:	compositor
	(cd tests; python small_tests.py)
	(cd tests; python saojose_tests.py)

